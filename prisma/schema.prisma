generator client {
  provider = "prisma-client-js"
  // sortie par défaut -> nécessaire pour Prisma Studio
  log      = ["query", "info", "warn", "error"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String        @id @default(cuid())
  email       String        @unique
  name        String?
  image       String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  userModules UserModule[]  // <-- relation explicite
}

model Module {
  id          String        @id @default(cuid())
  title       String
  slug        String        @unique
  content     String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  userModules UserModule[]  // <-- relation explicite
}

model UserModule {
  userId      String
  moduleId    String
  completed   Boolean   @default(false)
  completedAt DateTime?

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  module Module @relation(fields: [moduleId], references: [id], onDelete: Cascade)

  @@id([userId, moduleId])
  @@index([userId])
  @@index([moduleId])
  // @@map("user_modules") // décommente si tu veux nommer la table SQL
}
